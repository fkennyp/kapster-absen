{% extends 'base.html' %}
{% block title %}Laporan Absensi{% endblock %}
{% block content %}
<h1>Laporan Absensi</h1>

<!-- Card untuk Filter -->
<div class="card">
    <h3>Filter Laporan Absensi</h3>
    <form method="get" class="filter-form">
        <div>
            <label for="start">Start</label>
            <input type="date" id="start" name="start" value="{{ start or '' }}">
        </div>
        <div>
            <label for="end">End</label>
            <input type="date" id="end" name="end" value="{{ end or '' }}">
        </div>
        <div>
            <label for="user_id">User</label>
            <select id="user_id" name="user_id">
                <option value="">All</option>
                {% for u in users %}
                <option value="{{ u.id }}" {% if user_id==u.id %}selected{% endif %}>{{ u.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <button type="submit" class="btn">Filter</button>
            <a class="btn"
               href="/reports/export.xlsx?start={{ start or '' }}&end={{ end or '' }}&user_id={{ user_id or '' }}">
               Export XLSX
            </a>
        </div>
    </form>
</div>

<!-- Card untuk Table -->
<div class="card">
    <h3>Data Laporan Absensi ({{ rows|length }})</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Name</th>
                <th>Check In</th>
                <th>Check Out</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            {% for r in rows %}
            <tr>
                <td>{{ r.date }}</td>
                <td>{{ r.user.name }}</td>
                <td>{% if r.check_in %}{{ r.check_in.strftime('%H:%M') }}{% endif %}</td>
                <td>{% if r.check_out %}{{ r.check_out.strftime('%H:%M') }}{% endif %}</td>
                <td>{{ r.notes }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}